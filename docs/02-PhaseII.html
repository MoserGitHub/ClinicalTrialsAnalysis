<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Clinical trial analysis - 3&nbsp; Phase II trials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./references.html" rel="next">
<link href="./01-NI.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.27/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-PhaseII.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Phase II trials</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Clinical trial analysis</a> 
        <div class="sidebar-tools-main">
    <a href="./Clinical-trial-analysis.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-NI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Power and sample size calculations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-PhaseII.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Phase II trials</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">3.1</span> Background</a></li>
  <li><a href="#decision-rules-for-stopping-the-trial" id="toc-decision-rules-for-stopping-the-trial" class="nav-link" data-scroll-target="#decision-rules-for-stopping-the-trial"><span class="header-section-number">3.2</span> Decision rules for stopping the trial</a></li>
  <li><a href="#simulation-study" id="toc-simulation-study" class="nav-link" data-scroll-target="#simulation-study"><span class="header-section-number">3.3</span> Simulation study</a>
  <ul>
  <li><a href="#prior-with-a0.4-b0.6" id="toc-prior-with-a0.4-b0.6" class="nav-link" data-scroll-target="#prior-with-a0.4-b0.6"><span class="header-section-number">3.3.1</span> Prior with a=0.4, b=0.6</a></li>
  <li><a href="#prior-with-a1-b4" id="toc-prior-with-a1-b4" class="nav-link" data-scroll-target="#prior-with-a1-b4"><span class="header-section-number">3.3.2</span> Prior with a=1, b=4</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Phase II trials</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Phase II trials are often single-arm trials in early phases but can also be multi-arm (non-)randomized controlled trials in later phases <span class="citation" data-cites="Mossop2022">[<a href="references.html#ref-Mossop2022" role="doc-biblioref">1</a>]</span>. The aim of early phase-II designs is to assess efficacy of a new treatment measured by clinical response in a small population of 30-100 patients. Early phase II trials can be designed as two- or three stage trials using frequentist approaches like Simon’s two stage design. In this chapter we use a Bayesian predictive probability approach to analyse an early phase-II trial <span class="citation" data-cites="Lee2008">[<a href="references.html#ref-Lee2008" role="doc-biblioref">2</a>]</span> <span class="citation" data-cites="Sambucini2021">[<a href="references.html#ref-Sambucini2021" role="doc-biblioref">3</a>]</span>. The aim is to compare two different decision rules for early stopping the trial: One uses the posterior distribution given the interim data, the second one uses the predictive distribution given the interim data and future events.</p>
<section id="background" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="background"><span class="header-section-number">3.1</span> Background</h2>
<p>Let <span class="math inline">\(p\)</span> the true toxicity rate and <span class="math inline">\(\pi \sim Beta(a,b)\)</span> be a design prior on <span class="math inline">\(p\)</span>. Our null hypothesis of interest is <span class="math inline">\(H_0: p \leq p_0\)</span> versus <span class="math inline">\(H_1: p&gt;p_0\)</span>, that is, we compare, say, the clinical response <span class="math inline">\(p\)</span> toa prespecified threshold <span class="math inline">\(p_0\)</span>. Suppose that we plan interim looks <span class="math inline">\(j\geq 1\)</span> after <span class="math inline">\(N_j\)</span> patients were recruited and <span class="math inline">\(r_j\)</span> toxicity events occurred. Under the prior <span class="math inline">\(\pi\)</span> the posterior distribution is beta distributed <span class="math inline">\(p|r_j \sim Beta(a+r_j, b+N_j-r_j)\)</span>. Suppose that we plan to recruit <span class="math inline">\(N_{max}\)</span> patients. Let <span class="math inline">\(Y_j\)</span> be the number of toxicities in future <span class="math inline">\(m_j=N_{max}-N_j\)</span> patients at interim look <span class="math inline">\(j\geq 1\)</span>. Under the prior <span class="math inline">\(\pi\)</span>, <span class="math inline">\(Y_j\)</span> is beta-binomial distributed <span class="math inline">\(Y_j \sim Betabinomal(i|m_j, a+r_j, b+N_j-r_j)\)</span> and <span class="math inline">\(p|r_j,y_j \sim Beta(a+r_j+y_j, b+N_{max}-N_j-r_j-y_i)\)</span>.</p>
<hr>
<p><strong>Working example</strong></p>
<p>Suppose that the goal of a phase-II trial is to evaluate safety of new chemotherapy treatment investigating the discontinuation rate <span class="math inline">\(p\)</span> as primary endpoint. Discontinuation is defined based on toxicity grading from the US National Cancer Institute Common Terminology Criteria for Adverse Events (CTCAE).</p>
<hr>
</section>
<section id="decision-rules-for-stopping-the-trial" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="decision-rules-for-stopping-the-trial"><span class="header-section-number">3.2</span> Decision rules for stopping the trial</h2>
<p><strong>Early stopping using the posterior distribution</strong></p>
<p>The decision to the stop the trial early is based on the decision rule <span class="math inline">\(P(p&gt; p_0|N_j)&gt;\theta_T\)</span>, that is, the posterior distribution given the interim data. If the trial is not stopped early we recruit more patients until <span class="math inline">\(N_{max}\)</span> is reached.</p>
<p><strong>Early stopping using the predictive distribution</strong></p>
<p>Let <span class="math inline">\(T_{j,i}:=P(p&gt; p_0|N_j, Y_j=i)\)</span>, that is, the posterior distribution given the interim data and future events. Note that because <span class="math inline">\(Y_j\)</span> are not observed events <span class="math inline">\(T_{j,i}\)</span> are random variables. The predictive probability for a successful (safe) trial is</p>
<p><span class="math display">\[
PP_j=\sum_{i\leq m} P(Y_j=i|r_j)\cdot I(T_{j,i}&gt;\theta_T), \quad j\geq 1.
\]</span> This is the expectation of <span class="math inline">\(T_{j,i}\)</span> given the interim data <span class="math inline">\(j\geq 1\)</span> <span class="citation" data-cites="Lee2008">[<a href="references.html#ref-Lee2008" role="doc-biblioref">2</a>]</span>. If <span class="math inline">\(PP_j&gt;\theta_S\)</span> then we stop the trial because of safety concerns, otherwise we recruit more patients until <span class="math inline">\(N_{max}\)</span> is reached. Usually, <span class="math inline">\(\theta_S\)</span> is chosen to be high (&gt;0.8) <span class="citation" data-cites="Sambucini2021">[<a href="references.html#ref-Sambucini2021" role="doc-biblioref">3</a>]</span>.</p>
<hr>
<p><strong>Working example</strong></p>
<p>Based on prior evidence <span class="math inline">\(p_0\)</span> is set to 0.2. This threshold is based on a result from a previous study where the treatment discontinuation was estimated with 0.17 with 95% confidence intervals (0.10-0.27). Because we want to be conservative we set the parameters for a beta prior to <span class="math inline">\(a=0.4\)</span> and <span class="math inline">\(b=0.6\)</span>. The mean of the prior is then 0.4. For illustrating purposes we also show a prior with a prior weight of 5 patients which is centered on <span class="math inline">\(p=0.2\)</span> (<span class="math inline">\(a=1\)</span>, <span class="math inline">\(b=4\)</span>).</p>
<div class="cell">
<details>
<summary>Show R code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior information</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>a_0 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="fl">0.001</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data_prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, <span class="at">y=</span><span class="fu">dbeta</span>(x, a_0, b_0), <span class="at">type=</span><span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior information</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>a_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>data_prior <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_prior, <span class="fu">data.frame</span>(x, <span class="at">y=</span><span class="fu">dbeta</span>(x, a_0, b_0), <span class="at">type=</span><span class="dv">2</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>data_prior<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_prior<span class="sc">$</span>type, <span class="at">levels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"a=0.4, b=0.6"</span>, <span class="st">"a=1, b=4"</span>))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_prior <span class="sc">%&gt;%</span> <span class="fu">filter</span>(y<span class="sc">&lt;</span><span class="dv">5</span>), <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">linetype=</span>type, <span class="at">group=</span>type))<span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype</span>(<span class="st">"Prior parameters"</span>)<span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.4</span>, <span class="at">colour=</span><span class="st">"red"</span>, <span class="at">linetype=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.2</span>, <span class="at">colour=</span><span class="st">"red"</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Different beta prior parameter choices"</span>)<span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="fu">c</span>(<span class="st">"Red vertical lines indicate mean values of priors."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show R code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p_0_max <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior information</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>a_0 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>n_max <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, n_max, <span class="dv">5</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n_max</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> n_max<span class="sc">-</span>r</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.001</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>theta_T <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">n=</span>n, <span class="at">r=</span>r) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n<span class="sc">&gt;=</span>r) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">i=</span>n_max<span class="sc">-</span>n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">expandRows</span>(data, <span class="at">count=</span><span class="dv">3</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(n, r) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">m=</span>n_max<span class="sc">-</span>n, <span class="at">ind=</span><span class="dv">1</span>, <span class="at">i=</span><span class="fu">cumsum</span>(ind)<span class="sc">-</span><span class="dv">1</span>, <span class="at">ind=</span><span class="cn">NULL</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cond_postprob=</span><span class="fu">dbbinom</span>(i, <span class="at">size=</span>m, <span class="at">alpha=</span>a_0<span class="sc">+</span>r, <span class="at">beta=</span>b_0<span class="sc">+</span>n<span class="sc">-</span>r), </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Ti=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pbeta</span>(p_0_max, a_0<span class="sc">+</span>r<span class="sc">+</span>i, b_0<span class="sc">+</span>n_max<span class="sc">-</span>r<span class="sc">-</span>i), </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ind=</span><span class="fu">ifelse</span>(Ti<span class="sc">&gt;</span>theta_T, <span class="dv">1</span>, <span class="dv">0</span>), n_max)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(n_max, n, r, m, i, cond_postprob, Ti, ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Suppose we plan a phase-II with a maximum of <span class="math inline">\(N_{max}=35\)</span> patients. Let us consider the situation where we have reached an initial <span class="math inline">\(N_1=10\)</span> with <span class="math inline">\(r_1=2\)</span> observed toxicities and we have to decide whether to stop or continue the trial. Specifically, we calculate for each potential future toxicity from <span class="math inline">\(m_1\)</span> patients and decide whether <span class="math inline">\(T_{i,1}&gt;\theta_T=0.75\)</span>. The column <em>cond_postprob</em> in the following table is <span class="math inline">\(p|r_1,y_i\)</span> (because it is conditional on the future outcome <span class="math inline">\(Y_{j,i}=i\)</span>) and the column <span class="math inline">\(Ti\)</span> corresponds to <span class="math inline">\(T_{1,i}\)</span>.</p>
<div class="cell">
<details>
<summary>Show R code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n<span class="sc">==</span><span class="dv">10</span>, r<span class="sc">==</span><span class="dv">2</span>, i<span class="sc">&lt;=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 8
# Groups:   n, r [1]
   n_max     n     r     m     i cond_postprob      Ti   ind
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1    35    10     2    25     0       0.0434  0.00789     0
 2    35    10     2    25     1       0.0799  0.0315      0
 3    35    10     2    25     2       0.103   0.0881      0
 4    35    10     2    25     3       0.114   0.190       0
 5    35    10     2    25     4       0.114   0.334       0
 6    35    10     2    25     5       0.107   0.500       0
 7    35    10     2    25     6       0.0958  0.661       0
 8    35    10     2    25     7       0.0821  0.793       1
 9    35    10     2    25     8       0.0678  0.887       1
10    35    10     2    25     9       0.0542  0.945       1
11    35    10     2    25    10       0.0419  0.976       1
12    35    10     2    25    11       0.0313  0.990       1
13    35    10     2    25    12       0.0227  0.997       1
14    35    10     2    25    13       0.0159  0.999       1
15    35    10     2    25    14       0.0107  1.00        1
16    35    10     2    25    15       0.00690 1.00        1</code></pre>
</div>
</div>
<p>Based on this information we calculate <span class="math inline">\(PP_1\)</span> and decide based on the threshold <span class="math inline">\(\theta_S=0.9\)</span> whether to stop the trial early or to accrual more patients. For the decision rule based on the posterior probability we calculate the decision to stop the trial using the posterior distribution and use the threshold <span class="math inline">\(\theta_T=0.75\)</span>.</p>
<div class="cell">
<details>
<summary>Show R code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>threshold_safety <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Early stopping using predictive distribution</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>data_pp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(n, r) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">pp=</span><span class="fu">round</span>(<span class="fu">sum</span>(cond_postprob<span class="sc">*</span>ind),<span class="dv">6</span>), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">stop_pp=</span><span class="fu">ifelse</span>(pp<span class="sc">&gt;</span>threshold_safety, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Early stopping using posterior distribution</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>data_pp <span class="ot">&lt;-</span> data_pp <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stop_postdist=</span><span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pbeta</span>(p_0_max, a_0<span class="sc">+</span>r, b_0<span class="sc">+</span>n<span class="sc">-</span>r)<span class="sc">&gt;</span>theta_T, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n<span class="sc">==</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
# Groups:   n [1]
       n     r      pp stop_pp stop_postdist
   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;
 1    10     0 0.00552       0             0
 2    10     1 0.0889        0             0
 3    10     2 0.343         0             0
 4    10     3 0.678         0             1
 5    10     4 0.903         1             1
 6    10     5 0.983         1             1
 7    10     6 0.999         1             1
 8    10     7 1.00          1             1
 9    10     8 1.00          1             1
10    10     9 1             1             1
11    10    10 1             1             1</code></pre>
</div>
</div>
<p>For each interim look <span class="math inline">\(j\geq1\)</span> we can then calculate stopping of safety boundaries of the trial. Here we assumed that we recruit 5 additional patients if we do not stop the trial early.</p>
<div class="cell">
<details>
<summary>Show R code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_pp_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(data_pp, <span class="at">cols=</span><span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>stop_boundaries <span class="ot">&lt;-</span> data_pp_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, n) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">r=</span><span class="fu">min</span>(r), <span class="at">stop=</span><span class="cn">NULL</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>stop_boundaries<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(stop_boundaries<span class="sc">$</span>name, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"stop_postdist"</span>, <span class="st">"stop_pp"</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Posterior distribution"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Predictive distribution"</span>))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stop_boundaries, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>r, <span class="at">linetype=</span>name))<span class="sc">+</span><span class="fu">geom_step</span>()<span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(stop_boundaries<span class="sc">$</span>r)), </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span> <span class="fu">max</span>(stop_boundaries<span class="sc">$</span>r))<span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number of toxic events"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Number of patients at interim analysis"</span>)<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stopping for safety boundaries"</span>)<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="simulation-study" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="simulation-study"><span class="header-section-number">3.3</span> Simulation study</h2>
<section id="prior-with-a0.4-b0.6" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="prior-with-a0.4-b0.6"><span class="header-section-number">3.3.1</span> Prior with a=0.4, b=0.6</h3>
<p>We set up a simulation study to quantify operations characteristics (type-I error, type-II error, the probability to declare toxicity and expected number of patients and toxicities) with the following parameters</p>
<ul>
<li>Beta prior parameters: a=0.4, b=0.6</li>
<li>True <span class="math inline">\(p\)</span>: 0.2, 0.25, 0.3</li>
<li><span class="math inline">\(p_0\)</span>: 0.2</li>
<li><span class="math inline">\(N_0\)</span>: 10</li>
<li>Cohort increase: 5</li>
<li><span class="math inline">\(N_{max}\)</span>: 30, 35, 40</li>
<li><span class="math inline">\(\theta_T\)</span>: 0.75, 0.9</li>
<li><span class="math inline">\(\theta_S\)</span>: 0.8, 0.9, 1</li>
<li>Number of simulation runs: 1000</li>
</ul>
<p>Stopping decision rules:</p>
<ul>
<li>Posterior distribution: Stop early if <span class="math inline">\(P(p&gt; p_0|N_j)&gt;\theta_T\)</span>,</li>
<li>Safety threshold: Stop early if <span class="math inline">\(T_{j,i}&gt;\theta_T\)</span> and <span class="math inline">\(PP_j&gt;\theta_S\)</span>.</li>
</ul>
<p>Note that the type-I and type-II errors correspond to the proportion of trials which stopped early. If the maximal number of patients was reached the trial cannot be stopped early.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-70daacc166bbebde5dfc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-70daacc166bbebde5dfc">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;30&quot;,&quot;35&quot;,&quot;40&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Theta_T: 0.75&quot;,&quot;Theta_T: 0.8&quot;,&quot;Theta_T: 0.9&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;True p=0.2 (H0)&quot;,&quot;True p=0.25 (H1)&quot;,&quot;True p=0.3 (H1)&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Safety threshold: 0.8&quot;,&quot;Safety threshold: 0.9&quot;,&quot;Safety threshold: 1&quot;,&quot;Posterior distribution&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.01\" data-max=\"0.871\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.01\" data-max=\"0.897\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.19982\" data-max=\"0.352538\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"16.215\" data-max=\"39.94\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4.626\" data-max=\"11.475\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40"],["Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9"],["True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)"],["Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution"],[0.251,0.133,0.09,0.394,0.487,0.329,0.218,0.599,0.669,0.554,0.38,0.766,0.18,0.094,0.016,0.178,0.383,0.214,0.071,0.372,0.575,0.418,0.197,0.559,0.274,0.211,0.06,0.421,0.495,0.403,0.182,0.643,0.75,0.659,0.382,0.822,0.123,0.064,0.017,0.211,0.259,0.186,0.094,0.433,0.474,0.352,0.228,0.662,0.289,0.251,0.145,0.462,0.537,0.5,0.377,0.698,0.743,0.707,0.618,0.871,0.213,0.107,0.01,0.191,0.387,0.231,0.067,0.429,0.602,0.454,0.198,0.645],[0.31,0.252,0.09,0.423,0.588,0.503,0.218,0.653,0.782,0.715,0.38,0.824,0.209,0.155,0.016,0.208,0.435,0.341,0.071,0.426,0.652,0.613,0.197,0.633,0.347,0.318,0.06,0.453,0.621,0.553,0.182,0.678,0.846,0.799,0.382,0.864,0.138,0.089,0.017,0.215,0.313,0.288,0.094,0.442,0.545,0.51,0.228,0.679,0.36,0.348,0.145,0.485,0.634,0.615,0.377,0.733,0.847,0.831,0.618,0.897,0.226,0.145,0.01,0.198,0.433,0.336,0.067,0.454,0.66,0.591,0.198,0.689],[0.223522,0.211453,0.202529,0.234438,0.293278,0.279073,0.256686,0.288556,0.341829,0.337912,0.309036,0.338606,0.221812,0.214106,0.201005,0.217678,0.28715,0.273788,0.250755,0.286699,0.335048,0.337468,0.306832,0.337292,0.228592,0.224901,0.205603,0.238934,0.290506,0.28872,0.253835,0.289736,0.352538,0.351504,0.311765,0.342364,0.217363,0.206173,0.200086,0.223334,0.272626,0.27544,0.252057,0.289658,0.335759,0.332935,0.309895,0.34977,0.225344,0.232301,0.20219,0.245497,0.293675,0.292924,0.261942,0.2995,0.344528,0.348262,0.317951,0.346044,0.231744,0.220231,0.19982,0.220789,0.293848,0.277562,0.249607,0.287246,0.344155,0.336906,0.305337,0.346886],[25.98,28.38,29.425,23,22.255,25.74,28.475,19.56,19.215,22.65,27.015,16.215,26.97,28.56,29.92,27.245,23.805,26.73,29.625,24.205,21.125,23.96,28.91,21.115,29.525,30.795,34.57,25.875,25.255,27.175,33.75,21.295,19.805,22.215,31.89,17.07,32.815,33.8,34.905,31.045,30.685,31.64,34.385,26.93,27.015,28.825,33.29,22.13,33.495,34.495,38.905,28.045,27.245,29.405,36.98,22.05,22.11,24.15,34.18,17.34,34.83,37.715,39.94,35.565,30.82,35.245,39.515,30.32,26.465,30.795,38.36,24.71],[5.092,5.642,5.858,4.626,5.657,6.459,7.103,4.881,5.773,6.77,7.965,4.829,5.371,5.748,5.997,5.37,5.907,6.664,7.358,6.1,6.21,7.256,8.707,6.246,5.86,6.13,7.024,5.183,6.285,6.786,8.394,5.236,6.101,6.704,9.577,5.151,6.593,6.634,6.967,6.182,7.566,7.962,8.564,6.739,8.017,8.582,10.089,6.649,6.589,7.046,7.722,5.642,6.766,7.37,9.401,5.556,6.574,7.204,10.435,5.238,7.085,7.728,7.969,7.018,7.815,8.884,9.776,7.517,7.893,9.211,11.475,7.364]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>n_max<\/th>\n      <th>theta_T<\/th>\n      <th>true_p0<\/th>\n      <th>safety_threshold<\/th>\n      <th>stop_safety<\/th>\n      <th>stop_tox<\/th>\n      <th>obs_tox<\/th>\n      <th>exp_n<\/th>\n      <th>exp_r<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="prior-with-a1-b4" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="prior-with-a1-b4"><span class="header-section-number">3.3.2</span> Prior with a=1, b=4</h3>
<p>We use the same simulation approach as in the previous subsection but using a a Beta prior with parameters a=1 and b=4.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="02-PhaseII_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a8bb8b81cc8868d39666" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a8bb8b81cc8868d39666">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;30&quot;,&quot;35&quot;,&quot;40&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Theta_T: 0.75&quot;,&quot;Theta_T: 0.8&quot;,&quot;Theta_T: 0.9&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;True p=0.2 (H0)&quot;,&quot;True p=0.25 (H1)&quot;,&quot;True p=0.3 (H1)&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Safety threshold: 0.8&quot;,&quot;Safety threshold: 0.9&quot;,&quot;Safety threshold: 1&quot;,&quot;Posterior distribution&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.001\" data-max=\"0.825\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.001\" data-max=\"0.84\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.198907\" data-max=\"0.352975\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"18.79\" data-max=\"39.8\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"5.1\" data-max=\"11.374\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","35","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40","40"],["Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.75","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9","Theta_T: 0.9"],["True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.2 (H0)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.25 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)","True p=0.3 (H1)"],["Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution","Safety threshold: 0.8","Safety threshold: 0.9","Safety threshold: 1","Posterior distribution"],[0.19,0.151,0.049,0.275,0.369,0.312,0.152,0.52,0.594,0.557,0.33,0.72,0.065,0.04,0.021,0.111,0.188,0.099,0.055,0.268,0.37,0.225,0.143,0.427,0.252,0.182,0.079,0.319,0.478,0.387,0.209,0.594,0.663,0.617,0.341,0.792,0.101,0.048,0.001,0.15,0.247,0.13,0.025,0.302,0.46,0.336,0.086,0.519,0.15,0.118,0.072,0.358,0.358,0.308,0.236,0.615,0.574,0.54,0.465,0.825,0.144,0.065,0.039,0.145,0.339,0.185,0.143,0.326,0.56,0.425,0.357,0.591],[0.286,0.25,0.049,0.323,0.524,0.504,0.152,0.586,0.763,0.732,0.33,0.789,0.086,0.069,0.021,0.121,0.248,0.216,0.055,0.314,0.471,0.417,0.143,0.503,0.318,0.279,0.079,0.35,0.591,0.566,0.209,0.64,0.781,0.784,0.341,0.839,0.122,0.103,0.001,0.172,0.31,0.244,0.025,0.342,0.535,0.531,0.086,0.591,0.202,0.173,0.072,0.361,0.468,0.454,0.236,0.624,0.723,0.711,0.465,0.84,0.167,0.107,0.039,0.164,0.383,0.297,0.143,0.375,0.625,0.603,0.357,0.644],[0.2212,0.213194,0.199554,0.223006,0.283995,0.27625,0.257623,0.28616,0.34405,0.336773,0.310921,0.343801,0.208952,0.203362,0.200772,0.211934,0.267173,0.265026,0.246193,0.277256,0.330071,0.315335,0.302452,0.333963,0.22714,0.220769,0.201529,0.229085,0.29343,0.281029,0.256483,0.292474,0.338166,0.33972,0.309535,0.352975,0.214116,0.210118,0.198907,0.220345,0.277617,0.260186,0.251201,0.282281,0.331758,0.332112,0.302207,0.340547,0.213615,0.213885,0.200416,0.229113,0.282448,0.279019,0.251635,0.291722,0.333761,0.338118,0.306716,0.348797,0.220179,0.206398,0.202264,0.217312,0.284325,0.263671,0.254465,0.275792,0.339222,0.329693,0.306626,0.343937],[26.92,28.235,29.73,25.92,24.195,25.95,29.07,22.54,20.77,22.86,27.865,18.79,29.155,29.49,29.895,28.455,27.51,28.755,29.725,26.225,25.255,27.315,29.28,23.775,29.965,32.12,34.52,29.17,25.635,28.965,33.66,24.37,21.86,25.105,32.555,19.67,33.4,34.24,34.995,32.355,31.235,33.155,34.85,29.775,27.995,30.14,34.525,25.75,36.915,37.765,39.615,32.37,32.6,34.54,38.58,26.785,28.255,30.205,36.945,20.91,37.325,38.96,39.8,36.87,33.35,36.735,39.18,33.545,29.045,32.58,37.785,27.775],[5.316,5.638,5.883,5.1,6.031,6.479,7.349,5.653,6.301,6.899,8.413,5.645,5.859,5.84,5.98,5.673,6.801,7.298,7.273,6.606,7.575,8.068,8.768,7.122,5.938,6.496,6.888,5.777,6.413,7.278,8.488,6.111,6.391,7.538,9.851,5.998,6.727,6.978,6.96,6.56,7.953,8.214,8.717,7.543,8.342,9.169,10.351,7.717,7.275,7.537,7.887,6.383,8.096,8.684,9.546,6.622,8.318,9.101,11.08,6.249,7.615,7.788,8.018,7.352,8.4,9.041,9.865,8.287,8.639,9.789,11.374,8.295]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>n_max<\/th>\n      <th>theta_T<\/th>\n      <th>true_p0<\/th>\n      <th>safety_threshold<\/th>\n      <th>stop_safety<\/th>\n      <th>stop_tox<\/th>\n      <th>obs_tox<\/th>\n      <th>exp_n<\/th>\n      <th>exp_r<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-Mossop2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Mossop H, Grayling MJ, Gallagher FA, Welsh SJ, Stewart GD, Wason JMS. Advantages of multi-arm non-randomised sequentially allocated cohort designs for phase II oncology trials. British Journal of Cancer. 2022;126: 204–210. doi:<a href="https://doi.org/10.1038/s41416-021-01613-5">10.1038/s41416-021-01613-5</a></div>
</div>
<div id="ref-Lee2008" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Lee JJ, Liu DD. A predictive probability design for phase II cancer clinical trials. Clinical Trials. 2008;5: 93–106. doi:<a href="https://doi.org/10.1177/1740774508089279">10.1177/1740774508089279</a></div>
</div>
<div id="ref-Sambucini2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Sambucini V. Efficacy and toxicity monitoring via bayesian predictive probabilities in phase II clinical trials. Statistical Methods &amp; Applications. 2021;30: 637–663. doi:<a href="https://doi.org/10.1007/s10260-020-00537-3">10.1007/s10260-020-00537-3</a></div>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-NI.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Power and sample size calculations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>